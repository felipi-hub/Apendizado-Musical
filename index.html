<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <title>Aprendizado Musical</title>
    <link rel="icon" href="img/icon2.png" type="image/png" />
    <style>
        body {
            font-family: 'Balsamiq Sans', 'Comic Sans MS', cursive, sans-serif;
            padding: 20px;
            background-color: #e0f7fa;
            color: #004d40;

            /* Adicionados para centralizar */
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
        }

        html {
            height: 100%;
        }

        h1,
        h2 {
            text-align: center;
            color: #ff6f00;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .container {
            max-width: 600px;
            background-color: #fff;
            padding: 70px;
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        input,
        button {
            display: block;
            margin: 15px 0;
            padding: 11px;
            width: 100%;
            font-size: 18px;
            border-radius: 15px;
            border: 2px solid #ff6f00;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, background-color 0.2s;
        }

        input {
            background-color: #f1f8e9;
        }

        button {
            background-color: #ffa000;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        button:hover {
            background-color: #ff6f00;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            padding-top: 50px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);

            align-items: center;
            justify-content: center;


        }

        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 20px;
            width: 90%;
            max-width: 450px;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);


        }

        .close {
            color: #ff6f00;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #d32f2f;
        }

        .note-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            justify-items: center;
            margin-top: 20px;
        }

        .treasure-box {
            width: 80px;
            height: 80px;
            background-image: url('img/treasure-closed.jpeg');
            background-size: cover;
            cursor: pointer;
            transition: transform 0.2s;
            border-radius: 12px;
        }

        .treasure-box.opened {
            background-image: url('img/treasure-open.png');
        }

        #feedback,
        #treasureFeedback {
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
        }

        #treasureScreen {
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        #challengeScreen {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .video-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .video-item iframe {
            width: 100%;
            height: 160px;
            border-radius: 10px;
        }

        .video-item p {
            margin-top: 8px;
            font-weight: bold;
            color: #333;
            text-align: center;
        }

        /* Responsividade para telas menores */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 30px 20px;
                width: 100%;
            }

            input,
            button {
                width: 100%;
                font-size: 16px;
                padding: 10px;
            }

            h1,
            h2 {
                font-size: 22px;
            }

            .note-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .treasure-box {
                width: 70px;
                height: 70px;
            }

            .modal-content {
                width: 95%;
                padding: 15px;
            }

            .video-item iframe {
                height: 200px;
            }
        }

        @media (max-width: 480px) {

            h1,
            h2 {
                font-size: 20px;
            }

            .treasure-box {
                width: 60px;
                height: 60px;
            }

            .video-item iframe {
                height: 180px;
            }

            .note-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

    <header>
        <h1>Aprendizado Musical</h1>
    </header>

    <div class="container" id="mainContent">
        <h2>Jogos Musicais</h2>
        <button onclick="openVideoModal()">üìπ V√≠deos de Aprendizado</button>
        <button onclick="startTabGame()">üéª Leitura de Tablatura (Violino)</button>
        <button onclick="startChallenge()">Desafio Musical</button>
        <button onclick="startTreasureHunt()">Ca√ßa ao Tesouro Musical</button>

        <h2>Atividades Interativas</h2>
        <button onclick="openModal()">üéµ Aprimorar Notas Musicais</button>
    </div>

    <!-- Modal para Aprimorar Notas -->
    <div id="notesModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3>Pratique as Notas Musicais!</h3>
            <p>Clique no bot√£o para ouvir e repetir as notas.</p>
            <button onclick="playNotes()">üîä Ouvir Notas</button>
        </div>
    </div>

    <!-- Tela do Desafio Musical -->
    <div id="challengeScreen">
        <h1>üé∂ Desafio Musical üé∂</h1>
        <p>Ou√ßa a nota e clique na nota correta!</p>
        <button id="playNoteBtn" onclick="playRandomNote()">‚ñ∂Ô∏è Ouvir Nota</button>

        <div class="note-buttons"
            style="margin-top: 30px; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
            <button onclick="checkAnswer('D√≥')">D√≥</button>
            <button onclick="checkAnswer('R√©')">R√©</button>
            <button onclick="checkAnswer('Mi')">Mi</button>
            <button onclick="checkAnswer('F√°')">F√°</button>
            <button onclick="checkAnswer('Sol')">Sol</button>
            <button onclick="checkAnswer('L√°')">L√°</button>
            <button onclick="checkAnswer('Si')">Si</button>
        </div>

        <div id="feedback"></div>
        <br />
        <button onclick="backToMain()">üîô Voltar</button>
    </div>

    <!-- Tela da Ca√ßa ao Tesouro -->
    <div id="treasureScreen">
        <h1>ü™ô Ca√ßa ao Tesouro Musical ü™ô</h1>
        <p>Encontre a nota escondida nos ba√∫s! üîç</p>
        <div id="noteGrid" class="note-grid"></div>
        <div id="treasureFeedback"></div>
        <button onclick="closeTreasureHunt()" style="margin-top: 30px;">üîô Voltar</button>
    </div>
    <!-- Tela de Leitura de Tablatura -->
    <div id="tabScreen" style="display: none; text-align: center; padding: 30px;">
        <h1>üéª Leitura de Tablatura (Violino)</h1>
        <p>Toque a sequ√™ncia certa de cordas e dedos!</p>
        <div id="tabInstruction" style="font-size: 20px; margin: 20px 0;"></div>
        <div id="stringButtons" style="display: flex; flex-direction: column; align-items: center; gap: 10px;"></div>
        <div id="tabFeedback" style="margin-top: 20px; font-weight: bold;"></div>
        <button onclick="backToMain()" style="margin-top: 30px;">üîô Voltar</button>
    </div>
    <!-- Modal de V√≠deos de Aprendizado -->
    <div id="videoModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeVideoModal()">&times;</span>
            <h3>V√≠deos de Aprendizado e Fixa√ß√£o</h3>
            <p>Assista aos v√≠deos abaixo para refor√ßar seus conhecimentos musicais:</p>

            <div class="video-grid">
                <div class="video-item">
                    <iframe src="https://www.youtube.com/embed/YBKANHPtxR4
" frameborder="0" allowfullscreen></iframe>
                    <p>Aula 1: Introdu√ß√£o √†s Notas Musicais</p>
                </div>
                <div class="video-item">
                    <iframe src=https://www.youtube.com/embed/fDjRBTI7t5I frameborder="0" allowfullscreen></iframe>
                    <p>Aula 2: Leitura de Partitura</p>
                </div>
                <div class="video-item">
                    <iframe src=https://www.youtube.com/embed/PVnbnMufHP8 frameborder="0" allowfullscreen></iframe>
                    <p>Aula 3: Leitura de Partitura</p>
                </div>
                <div class="video-item">
                    <iframe src=https://www.youtube.com/embed/O8AI8menEDw frameborder="0" allowfullscreen></iframe>
                    <p>Aula 3: Pr√°tica com Violino</p>
                </div>
                <div class="video-item">
                    <iframe src="https://www.youtube.com/embed/VIDEO_ID_3" frameborder="0" allowfullscreen></iframe>
                    <p>Aula 4: Pr√°tica com Violino</p>
                </div>
                <div class="video-item">
                    <iframe src="https://www.youtube.com/embed/VIDEO_ID_3" frameborder="0" allowfullscreen></iframe>
                    <p>Aula 4: Pr√°tica com Violino</p>
                </div>


                <!-- Adicione mais v√≠deos aqui -->
            </div>
        </div>
    </div>



    <script>
        // Vari√°veis globais
        const notes = ['D√≥', 'R√©', 'Mi', 'F√°', 'Sol', 'L√°', 'Si', 'D√≥', 'Si', 'L√°', 'Sol', 'F√°', 'R√©', 'D√≥'];
        let currentNote = '';

        // Arquivos de √°udio para as notas
        const noteAudioFiles = {
            'D√≥': 'do.mp3',
            'R√©': 're.mp3',
            'Mi': 'mi.mp3',
            'F√°': 'fa.mp3',
            'Sol': 'sol.mp3',
            'L√°': 'la.mp3',
            'Si': 'si.mp3'
        };

        // Fun√ß√£o para abrir o modal das notas
        function openModal() {
            document.getElementById('notesModal').style.display = 'flex';
        }

        // Fechar modal
        function closeModal() {
            document.getElementById('notesModal').style.display = 'none';
        }

        // Fecha modal se clicar fora
        window.onclick = function (event) {
            const modal = document.getElementById('notesModal');
            if (event.target === modal) {
                closeModal();
            }
        };

        // Fun√ß√£o para falar as notas em sequ√™ncia
        function playNotes() {
            const synth = window.speechSynthesis;
            const utterance = new SpeechSynthesisUtterance(notes.join(', '));
            utterance.lang = 'pt-BR';
            utterance.rate = 0.9;
            synth.speak(utterance);
        }
        function playNoteAudio(note) {
            const file = noteAudioFiles[note];
            if (!file) {
                console.error('Arquivo de √°udio n√£o encontrado para a nota:', note);
                return;
            }
            const audio = new Audio(`audios/${file}`);
            audio.play();
        }




        function playTabNote(string, finger) {
            const audioMap = {
                'G0': 'sol.mp3',
                'G1': 'la.mp3',
                'G2': 'si.mp3',
                'G3': 'do.mp3',

                'D0': 're.mp3',
                'D1': 'mi.mp3',
                'D2': 'fa.mp3',
                'D3': 'sol.mp3',

                'A0': 'la.mp3',
                'A1': 'si.mp3',
                'A2': 'do.mp3',
                'A3': 're.mp3',

                'E0': 'mi.mp3',
                'E1': 'fa.mp3',
                'E2': 'sol.mp3',
                'E3': 'la.mp3'
            };

            const fileName = audioMap[`${string}${finger}`];
            if (!fileName) {
                console.error('Nota n√£o encontrada:', string, finger);
                return;
            }

            const audio = new Audio(`audios/${fileName}`);
            audio.play();
        }



        // Tela do desafio
        function startChallenge() {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('challengeScreen').style.display = 'block';
            playRandomNote();
            clearFeedback();
        }

        // Tocar nota aleat√≥ria e definir atual
        function playRandomNote() {
            if (!notes || notes.length === 0) {
                console.error('Lista de notas est√° vazia ou indefinida.');
                return;
            }
            // Gera um √≠ndice aleat√≥rio
            const indexAleatorio = Math.floor(Math.random() * notes.length);
            // Pega a nota correspondente
            const notaSorteada = notes[indexAleatorio];
            // Atualiza a nota atual para verifica√ß√£o posterior
            currentNote = notaSorteada;
            // Toca o som da nota
            playNoteAudio(notaSorteada);
            // Limpa o feedback visual anterior
            clearFeedback();
        }

        // Verifica se acertou
        function checkTabAnswer(string, finger) {
            const expected = tablatureSequence[currentTabIndex];

            if (string === expected.string && finger === expected.finger) {
                playTabNote(string, finger); // Chame a fun√ß√£o correta para tocar o som
                speak(`Muito bem! ${string}${finger === 0 ? ' (corda solta)' : ` com dedo ${finger}`}`);
                currentTabIndex++;

                if (currentTabIndex >= tablatureSequence.length) {
                    updateTabFeedback('üéâ Parab√©ns! Voc√™ completou a m√∫sica!');
                    document.getElementById('tabInstruction').innerText = '‚úÖ Fim da sequ√™ncia.';
                } else {
                    updateTabFeedback('‚úÖ Correto! Pr√≥xima nota...');
                    updateTabInstruction();
                }
            } else {
                const msg = finger === 0 ? 'corda solta' : `dedo ${finger}`;
                updateTabFeedback(`‚ùå Ops! N√£o √© ${string} com ${msg}.`);
                speak('Tente novamente!');
            }
        }

        // Limpa o feedback
        function clearFeedback() {
            const feedbackEl = document.getElementById('feedback');
            feedbackEl.innerText = '';
        }

        // Voltar para a tela principal
        function backToMain() {
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('challengeScreen').style.display = 'none';
            document.getElementById('treasureScreen').style.display = 'none';
            document.getElementById('tabScreen').style.display = 'none';
            clearFeedback();
        }

        // Fala texto com s√≠ntese de voz
        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'pt-BR';
            utterance.rate = 0.9;
            speechSynthesis.speak(utterance);
        }

        // Ca√ßa ao Tesouro

        function startTreasureHunt() {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('challengeScreen').style.display = 'none';
            document.getElementById('treasureScreen').style.display = 'flex';
            setupTreasureGrid();
            clearTreasureFeedback();
        }

        function closeTreasureHunt() {
            document.getElementById('treasureScreen').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            clearTreasureFeedback();
        }

        function clearTreasureFeedback() {
            document.getElementById('treasureFeedback').innerText = '';
        }

        function setupTreasureGrid() {
            const grid = document.getElementById('noteGrid');
            grid.innerHTML = '';

            const hiddenNote = notes[Math.floor(Math.random() * notes.length)];
            let found = false;

            for (let i = 0; i < 6; i++) {
                const box = document.createElement('div');
                box.className = 'treasure-box';

                box.onclick = () => {
                    if (found || box.classList.contains('opened')) return;

                    const isFound = Math.random() < 0.3; // 30% chance
                    if (isFound) {
                        box.classList.add('opened');
                        speak(`Voc√™ encontrou a nota ${hiddenNote}!`);
                        document.getElementById('treasureFeedback').innerText = `üéâ Voc√™ encontrou a nota ${hiddenNote}!`;
                        playNoteAudio(hiddenNote);
                        found = true;
                    } else {
                        speak(' Continue procurando!');

                        document.getElementById('treasureFeedback').innerText = '‚ùå Nada aqui... tente outro!';
                    }
                };

                grid.appendChild(box);
            }
        }
        const tablatureSequence = [
            { string: 'D', finger: 0 }, // D
            { string: 'D', finger: 0 }, // D
            { string: 'A', finger: 1 }, // B
            { string: 'A', finger: 1 }, // B
            { string: 'A', finger: 0 }, // A
            { string: 'A', finger: 0 }, // A
            { string: 'D', finger: 0 }  // D
        ];

        let currentTabIndex = 0;

        function startTabGame() {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('tabScreen').style.display = 'block';
            currentTabIndex = 0;
            updateTabInstruction();
            updateTabFeedback('');
            renderTabButtons();
        }

        function renderTabButtons() {
            const container = document.getElementById('stringButtons');
            container.innerHTML = '';

            const strings = ['G', 'D', 'A', 'E'];
            for (let string of strings) {
                const row = document.createElement('div');
                row.style.display = 'flex';
                row.style.gap = '8px';

                for (let finger = 0; finger <= 3; finger++) {
                    const btn = document.createElement('button');
                    btn.innerText = `${string}${finger}`;
                    btn.onclick = () => checkTabAnswer(string, finger);
                    btn.style.minWidth = '60px';
                    btn.title = finger === 0 ? 'Corda Solta' : `Dedo ${finger}`;
                    row.appendChild(btn);
                }

                container.appendChild(row);
            }
        }

        function updateTabInstruction() {
            const step = tablatureSequence[currentTabIndex];
            const desc = step.finger === 0 ? 'corda solta' : `dedo ${step.finger}`;
            document.getElementById('tabInstruction').innerText = `Toque: ${step.string} com ${desc}`;
        }

        function updateTabFeedback(msg) {
            document.getElementById('tabFeedback').innerText = msg;
        }
        function checkTabAnswer(string, finger) {
            const expected = tablatureSequence[currentTabIndex];

            if (string === expected.string && finger === expected.finger) {
                playTabNote(string, finger); // üëà tocar som aqui
                speak(`Muito bem! ${string}${finger === 0 ? ' (corda solta)' : ` com dedo ${finger}`}`);
                currentTabIndex++;

                if (currentTabIndex >= tablatureSequence.length) {
                    updateTabFeedback('üéâ Parab√©ns! Voc√™ completou a m√∫sica!');
                    document.getElementById('tabInstruction').innerText = '‚úÖ Fim da sequ√™ncia.';
                } else {
                    updateTabFeedback('‚úÖ Correto! Pr√≥xima nota...');
                    updateTabInstruction();
                }
            } else {
                const msg = finger === 0 ? 'corda solta' : `dedo ${finger}`;
                updateTabFeedback(`‚ùå Ops! N√£o √© ${string} com ${msg}.`);
                speak('Tente novamente!');
            }
        }
        function checkAnswer(userAnswer) {
            if (!currentNote) {
                console.warn('Nenhuma nota foi sorteada ainda.');
                return;
            }

            const feedbackEl = document.getElementById('feedback');

            if (userAnswer === currentNote) {
                feedbackEl.innerText = `‚úÖ Correto! Era ${currentNote}!`;
                speak(`Muito bem! Voc√™ acertou. Era ${currentNote}!`);
                currentNote = ''; // limpa para evitar repeti√ß√µes acidentais
            } else {
                feedbackEl.innerText = `‚ùå Errado! Tente novamente.`;
                speak(`Ops! N√£o √© ${userAnswer}. Tente novamente.`);
            }
        }
        function openVideoModal() {
            document.getElementById('videoModal').style.display = 'flex';
        }

        function closeVideoModal() {
            document.getElementById('videoModal').style.display = 'none';
        }

        // Fecha modal se clicar fora dele
        window.addEventListener('click', function (event) {
            const videoModal = document.getElementById('videoModal');
            if (event.target === videoModal) {
                closeVideoModal();
            }
        });





        // Tornando as fun√ß√µes acess√≠veis no escopo global para onclick inline
        window.startTabGame = startTabGame;
        window.openModal = openModal;
        window.closeModal = closeModal;
        window.playNotes = playNotes;
        window.startChallenge = startChallenge;
        window.playRandomNote = playRandomNote;
        window.checkAnswer = checkAnswer;
        window.backToMain = backToMain;
        window.startTreasureHunt = startTreasureHunt;
        window.closeTreasureHunt = closeTreasureHunt;
    </script>

</body>

</html>